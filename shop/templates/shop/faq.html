{% extends "shop/base.html" %}
{% block title %}常见问题 - 购物商城{% endblock %}
{% load static %}
{% block content %}

<!-- 页面头部 -->
<section class="bg-cover bg-center h-96" style="background-image: url('{% static 'images/faq-bg.jpg' %}')">
    <div class="container mx-auto px-6 md:px-12 h-full flex items-center justify-center text-center bg-black/60">
        <div class="text-white">
            <h1 class="text-4xl md:text-6xl font-bold mb-4">常见问题</h1>
            <p class="text-xl max-w-2xl mx-auto">
                您想知道的都在这里！如果没有找到答案，请随时 <a href="{% url 'shop:contact' %}" class="text-primary">联系我们</a>。
            </p>
        </div>
    </div>
</section>

<!-- 分类导航 -->
<section class="container mx-auto px-6 md:px-12 py-12">
    <div class="flex flex-col md:flex-row justify-center gap-6 mb-12">
        <a href="#order" class="px-4 py-2 rounded-full border border-neutral-300 hover:border-primary hover:text-primary transition-colors {% if active_category == 'order' %}bg-primary text-white{% endif %}">
            订单相关
        </a>
        <a href="#payment" class="px-4 py-2 rounded-full border border-neutral-300 hover:border-primary hover:text-primary transition-colors {% if active_category == 'payment' %}bg-primary text-white{% endif %}">
            支付问题
        </a>
        <a href="#return" class="px-4 py-2 rounded-full border border-neutral-300 hover:border-primary hover:text-primary transition-colors {% if active_category == 'return' %}bg-primary text-white{% endif %}">
            退换货
        </a>
        <a href="#account" class="px-4 py-2 rounded-full border border-neutral-300 hover:border-primary hover:text-primary transition-colors {% if active_category == 'account' %}bg-primary text-white{% endif %}">
            账户管理
        </a>
    </div>
</section>

<!-- 问题列表 -->
<section class="container mx-auto px-6 md:px-12 pb-16">
    <div id="order" class="mb-12 {% if active_category != 'order' %}hidden{% endif %}">
        <h2 class="text-2xl font-bold mb-6">订单相关</h2>
        <div class="space-y-4">
            <!-- 问题1 -->
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <button class="w-full px-6 py-4 text-left font-medium flex justify-between items-center focus:outline-none" onclick="toggleFAQ(this)">
                    <span>如何查询订单状态？</span>
                    <i class="fa fa-chevron-down text-neutral-400 transition-transform"></i>
                </button>
                <div class="px-6 pb-4 hidden">
                    <p class="text-neutral-600">
                        登录后进入 <strong>我的订单</strong> 页面，即可查看所有订单的状态（待付款/已发货/已完成等）。
                        您也可以通过订单确认邮件中的链接直接查询。
                    </p>
                </div>
            </div>

            <!-- 问题2 -->
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <button class="w-full px-6 py-4 text-left font-medium flex justify-between items-center focus:outline-none" onclick="toggleFAQ(this)">
                    <span>订单提交后可以修改吗？</span>
                    <i class="fa fa-chevron-down text-neutral-400 transition-transform"></i>
                </button>
                <div class="px-6 pb-4 hidden">
                    <p class="text-neutral-600">
                        订单提交后 <strong>30分钟内</strong> 可自行取消并重新下单。超过时限后，
                        请联系客服说明情况，我们会尽力协助您处理。
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div id="payment" class="mb-12 {% if active_category != 'payment' %}hidden{% endif %}">
        <h2 class="text-2xl font-bold mb-6">支付问题</h2>
        <div class="space-y-4">
            <!-- 问题1 -->
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <button class="w-full px-6 py-4 text-left font-medium flex justify-between items-center focus:outline-none" onclick="toggleFAQ(this)">
                    <span>支持哪些支付方式？</span>
                    <i class="fa fa-chevron-down text-neutral-400 transition-transform"></i>
                </button>
                <div class="px-6 pb-4 hidden">
                    <p class="text-neutral-600">
                        我们支持支付宝、微信支付、银联卡支付，以及部分地区的货到付款（COD）。
                    </p>
                </div>
            </div>

            <!-- 问题2 -->
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <button class="w-full px-6 py-4 text-left font-medium flex justify-between items-center focus:outline-none" onclick="toggleFAQ(this)">
                    <span>支付成功但订单未更新怎么办？</span>
                    <i class="fa fa-chevron-down text-neutral-400 transition-transform"></i>
                </button>
                <div class="px-6 pb-4 hidden">
                    <p class="text-neutral-600">
                        支付状态可能存在延迟，建议等待 <strong>5-10分钟</strong> 后刷新页面。
                        如仍未到账，请提供支付订单号联系客服查询。
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div id="return" class="mb-12 {% if active_category != 'return' %}hidden{% endif %}">
        <h2 class="text-2xl font-bold mb-6">退换货政策</h2>
        <div class="space-y-4">
            <!-- 问题1 -->
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <button class="w-full px-6 py-4 text-left font-medium flex justify-between items-center focus:outline-none" onclick="toggleFAQ(this)">
                    <span>如何申请退换货？</span>
                    <i class="fa fa-chevron-down text-neutral-400 transition-transform"></i>
                </button>
                <div class="px-6 pb-4 hidden">
                    <p class="text-neutral-600">
                        登录后在 <strong>我的订单</strong> 中找到对应商品，点击 <strong>申请售后</strong>，
                        选择退换货原因并上传凭证，审核通过后我们将安排上门取件或退款。
                    </p>
                </div>
            </div>

            <!-- 问题2 -->
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <button class="w-full px-6 py-4 text-left font-medium flex justify-between items-center focus:outline-none" onclick="toggleFAQ(this)">
                    <span>退换货需要多长时间？</span>
                    <i class="fa fa-chevron-down text-neutral-400 transition-transform"></i>
                </button>
                <div class="px-6 pb-4 hidden">
                    <p class="text-neutral-600">
                        退货商品签收后，我们会在 <strong>3-5个工作日</strong> 内完成质检并处理退款。
                        换货商品将在质检通过后 <strong>24小时内</strong> 重新发货。
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div id="account" class="mb-12 {% if active_category != 'account' %}hidden{% endif %}">
        <h2 class="text-2xl font-bold mb-6">账户管理</h2>
        <div class="space-y-4">
            <!-- 问题1 -->
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <button class="w-full px-6 py-4 text-left font-medium flex justify-between items-center focus:outline-none" onclick="toggleFAQ(this)">
                    <span>如何修改登录密码？</span>
                    <i class="fa fa-chevron-down text-neutral-400 transition-transform"></i>
                </button>
                <div class="px-6 pb-4 hidden">
                    <p class="text-neutral-600">
                        登录后进入 <strong>账户设置</strong> → <strong>安全中心</strong>，点击 <strong>修改密码</strong>，
                        按提示完成验证后即可设置新密码。
                    </p>
                </div>
            </div>

            <!-- 问题2 -->
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <button class="w-full px-6 py-4 text-left font-medium flex justify-between items-center focus:outline-none" onclick="toggleFAQ(this)">
                    <span>忘记密码如何找回？</span>
                    <i class="fa fa-chevron-down text-neutral-400 transition-transform"></i>
                </button>
                <div class="px-6 pb-4 hidden">
                    <p class="text-neutral-600">
                        在登录页面点击 <strong>忘记密码</strong>，输入注册邮箱或手机号，
                        我们将发送验证码到您的绑定设备，验证通过后即可重置密码。
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    // 折叠面板交互
    function toggleFAQ(button) {
        const content = button.nextElementSibling;
        const icon = button.querySelector('i');

        // 关闭其他打开的面板
        const allButtons = document.querySelectorAll('.faq-button');
        allButtons.forEach(b => {
            if (b !== button) {
                const otherContent = b.nextElementSibling;
                const otherIcon = b.querySelector('i');
                otherContent.classList.add('hidden');
                otherIcon.classList.remove('rotate-180');
            }
        });

        // 切换当前面板
        if (content.classList.contains('hidden')) {
            content.classList.remove('hidden');
            icon.classList.add('rotate-180');
        } else {
            content.classList.add('hidden');
            icon.classList.remove('rotate-180');
        }
    }

    // 分类导航点击事件
    document.querySelectorAll('[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const targetId = this.getAttribute('href').substring(1);
            const targetSection = document.getElementById(targetId);

            // 显示对应分类，隐藏其他分类
            document.querySelectorAll('[id^="order"], [id^="payment"], [id^="return"], [id^="account"]').forEach(section => {
                section.classList.add('hidden');
            });
            targetSection.classList.remove('hidden');

            // 更新导航激活状态
            const activeLink = document.querySelector(`[href="#${targetId}"]`);
            document.querySelectorAll('.faq-nav a').forEach(link => {
                link.classList.remove('bg-primary', 'text-white');
                link.classList.add('border-neutral-300', 'text-neutral-700');
            });
            activeLink.classList.add('bg-primary', 'text-white');
            activeLink.classList.remove('border-neutral-300', 'text-neutral-700');
        });
    });
</script>
{% endblock %}